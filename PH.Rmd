---
title: "Pruebas de hipótesis"
output:
  html_document:
    toc: true
    toc_depth: 5
---


# Prueba de hipótesis

Una hipótesis estadística es una aseveración o conjetura con respecto a una o más poblaciones.


## Tipos de hipótesis


$H_0$= Hipótesis nula, status quo

$H_1$= Hipótesis alternativa, sospecha




## Tipos de errores

|Decisión|$H_0$ verdadera|$H_0$ Falsa|
|:------:|:-------------:|:---------:|
|Aceptar $H_0$|$\checkmark$ | Error tipo II $\beta$|
|Rechazar $H_0$|Error tipo I $\alpha$|$\checkmark$|




Error tipo I falso negativo $\alpha$: Rechazar $H_0$, dado que es verdadera

Error tipo II falso positivo $\beta$: Aceptar $H_0$, dado que es falsa

**Ejemplos**


```{r, echo=F, out.width="80%", fig.align='center'}
knitr::include_graphics("imagen/embarazo.png")
```

 
|Formulación     |             $H_0$|          $H_1$| Falso positivo|Falso negativo|
|----------------|------------------|---------------|--------------------|--------------------|
|Una prueba de embarazo|No está embarazada|Está embarazada|Reportar que está embarazada cuando en realidad no está|Reportar que no está embarazada cuando en realidad lo está|
|Prueba de genero de un bebe|Feto femenino|Feto masculino|Reportar un feto masculino cuando en realidad es femenino|Reportar un feto femenino cuando en realidad es masculino|





## Pasos para realizar una prueba de hipótesis



```{r echo=FALSE}
library(DiagrammeR)

DiagrammeR("graph TB;
  A[Definir las hipótesis]-->F[Definir el error tipo I denotado por]
  F-->B{Calcular el estadístico}
  B-->D[Definir región de aceptación y rechazo]
  B-->C[Calcular valor p]
  C-->E[Tomar desición]
  D-->E[Tomar desición]
           ")
            
```

- Algunos videos de interés



<iframe width="280" height="160" src="https://www.youtube.com/embed/zP6JsuHm9Hg?list=RDCMUCMLQ_dQirjjwPjR8skwX3gA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>


## Tipos de pruebas según la región de aceptación y rechazo

**Hipótesis nula**

$$\Large H_0:\theta=\theta_0$$
**Hipótesis alternativa**


```{r echo=FALSE,fig.asp=0.6,fig.align='center' }

par(mfrow=c(1,3))
x=seq(-5,5,0.001)

# cola inferior

curve(dnorm(x, mean=0, sd=1),
      from=-5,to=5,
      ylab="Densidad",cex.sub=2,
      las=1, lwd=3, col="deepskyblue3",ylim=c(0,0.4),
      xaxt = "n",sub =  "Cola inferior")
mtext(expression(H[1] == theta ~ "<" ~ theta[0] ),side = 3,cex=1.3)

polygon(c(x[x <= -1.5],-1.5), c(dnorm(x[x<=-1.5]),0), col="lightblue")
axis(1, at = c(-4,-1.5, 0,4))

# cola superior

curve(dnorm(x, mean=0, sd=1),
      from=-5,to=5,
      ylab="Densidad",cex.sub=2,
      las=1, lwd=3, col="deepskyblue3",ylim=c(0,0.4),
      xaxt = "n",sub =  "Cola superior"  )
      mtext(expression(H[1] == theta ~ ">" ~ theta[0] ) , side = 3,cex=1.3)
      
      
polygon(c(x[x >=1.5],1.5), c(dnorm(x[x >=1.5]),0), col="lightblue")
axis(1, at = c(-4, 0,1.5, 4))
     
curve(dnorm(x, mean=0, sd=1),
      from=-5,to=5,
      ylab="Densidad",cex.sub=2,
      las=1, lwd=3, col="deepskyblue3",ylim=c(0,0.4),
      xaxt = "n",sub =  "Doble cola"  )
      mtext(expression(H[1] ~ theta !=  theta[0]) , side = 3,cex=1.3)

m <- 0.9

x=seq(-5,5,0.001)
text(0, .1,round(m,3),cex=1)
text(-2.5, .1,round((1-m)/2,3),cex=1)
text(2.5,.1,round((1-m)/2,3),cex=1)
ns=1-m
ns2=round(qnorm(ns/2,mean=0,sd=1),2)
ns3=round(qnorm((1-(ns/2)),mean=0,sd=1),2)
axis(1, at = c(-4,ns2, 0,ns3, 4))

polygon(c(x[x <= ns2], ns2), c(dnorm(x[x <=ns2]),0), col="lightblue")
polygon(c(x[x >= ns3], ns3), c(dnorm(x[x >=ns3]),0), col="lightblue")



```


## Valor p

• Probabilidad de obtener un estadístico (igual al que se obtuvo o más extremo)

• Probabilidad de equivocarse rechazando la hipótesis nula

• Se contrasta con el nivel de significancia $\alpha$

  - Si valor p < $\alpha$ Rechaza la hipótesis nula
    
  - Si valor p > $\alpha$  Acepta la hipotesis nula

# Pruebas de hipótesis para una muestra

## PH para la media

Se pueden considerar dos tipos de estadísticos

| Normal| t|
|:-------------------------:|:-------------------------:|
|$\Large z=\frac{\bar x-\mu}{\sigma/\sqrt n}$|$\Large t=\frac{\bar x-\mu}{s/\sqrt n}$|

```{r echo=FALSE}
library(DiagrammeR)

DiagrammeR("graph TB;
  
  A{sigma conocida}-->|Si| C[Normal]
  A-->|No| B{n mayor q 30}
  B-->|No| D[t student]
  B-->|Si| C
  
           ")
            
```

**Ejemplo**

Se desea verificar si un proceso de llenado de bolsas de café con 500 gr, está operando correctamente, para ello se toman muestras de tamaño 10 cada 4 horas, una muestra de bolsas tiene los siguientes resultados

|  502|  501|  497|  491|  496|  501|  502|  500|  489|  490|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|     |     |     |     |     |     |     |     |     |     |

```{r}
vec=c(502,501,497,491,496,501,502,500,489,490)
mean(vec)
sd(vec)

```

Está el proceso llenando bolsas conforme a lo que dice la envoltura?

**Siguiendo los pasos de las pruebas de hipótesis**

**1. Definir las hipótesis**

$$H_0:\quad \mu=500 gr$$
$$H_1:\quad \mu \neq 500 gr$$

**2. Calcular el estadístico**

según la normal o según la t de student??

Es la varianza conocida??

Es el tamaño de muestra n>30??



$$\Large t=\frac{\bar x-\mu}{s/\sqrt n}$$



$$\Large t=\frac{496.9-500}{5.17/\sqrt 10}=-1.89$$


**3. definir el valor p**


$$P(t_9<-1.89)=0.046$$





```{r}

t.test(vec,mu=500)

```





## PH para la proporción

## PH para la varianza

# Pruebas de hipótesis para dos muestras

## PH Diferencia de medias

## PH diferencia de medias pareadas

## Diferencia de proporciones

## Razón de varianzas

[Clase](https://github.com/estadisticaITM/estadisticaITM.github.io/blob/master/pruebas%20de%20hip%C3%B3tesis%20JTG.pdf)  

[Intervalos de confianza y test de hipótesis con R](https://github.com/estadisticaITM/estadisticaITM.github.io/blob/master/INTERVALOS%20DE%20CONFIANZA%20Y%20TEST%20DE%20HIPOTESIS%20CON%20R.pdf)



