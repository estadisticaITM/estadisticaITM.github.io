---
title: "Intervalos de confianza"
output:
  html_document:
    toc: true
    toc_depth: 5
---


[FÃ³rmulas](https://github.com/estadisticaITM/estadisticaITM.github.io/blob/master/f%C3%B3rmulas.pdf)

<a href="tallerIC.html" target="_blank"> Taller intervalos de confianza</a>

```{r echo=FALSE,out.width="80%",fig.align='center'}
library(DiagrammeR)
# A minimal plot
DiagrammeR("graph LR;
           PoblaciÃ³n-->|Distribuciones de muestreo| Muestra
           Muestra-->|Inferencial IC PH| PoblaciÃ³n")
```


# EstimaciÃ³n por intervalo


Una estimaciÃ³n por intervalo de un parÃ¡metro $\theta$ de la poblaciÃ³n es un intervalo de la forma: 

$$\hat \theta_{inf}<\theta<\hat \theta_{sup}$$
Donde los valores estimados dependen del valor estimado de $\theta$ y de la distribuciÃ³n de muestreo.



```{r, echo=F, out.width="80%", fig.align='center'}
knitr::include_graphics("imagen/ic.png")
```

 
# Intervalo de confianza

La inferencia estadÃ­stica consiste en aquellos mÃ©todos por medio de los cuales se realizan inferencias o generalizaciones acerca de una poblaciÃ³n. 




# Nivel de confianza y de significancia

Nivel de confianza: Probabilidad mÃ¡xima con la que se asegura que un parÃ¡metro a estimar se encuentra dentro de un intervalo estimado.

Nivel de significancia: MÃ¡ximo error que se comete en la estimaciÃ³n usualmente se denota como $\alpha$.

$$\huge NC+\alpha=1$$
Si se construyen 100 intervalos de la forma $\hat \theta_{inf}<\theta<\hat \theta_{sup}$ con un NC=0.97 entonces se espera que 97 de los 100 intervalos contengan el parÃ¡metro $\theta$


```{r echo=FALSE}
library(htmltools)
library(reactable)
library(crosstalk)


m <- 0.9
x=seq(-5,5,0.001)        
curve(dnorm(x, mean=0, sd=1),
          from=-5,
          to=5,
          ylab="Densidad",
          las=1, lwd=3, col="deepskyblue3",ylim=c(0,0.4),
          xaxt = "n")
    grid()


        
        text(0, .1,round(m,3),cex=2)
        text(-2.5, .1,round((1-m)/2,3),cex=2)
        text(2.5,.1,round((1-m)/2,3),cex=2)
        ns=1-m
        ns2=round(qnorm(ns/2,mean=0,sd=1),3)
        ns3=round(qnorm((1-(ns/2)),mean=0,sd=1),3)
        axis(1, at = c(-4,ns2, 0,ns3, 4))
        
        polygon(c(x[x <= ns2], ns2), c(dnorm(x[x <=ns2]),dnorm(max(x))), col="lightblue")
        polygon(c(x[x >= ns3], ns3), c(dnorm(x[x >=ns3]),dnorm(max(x))), col="lightblue")
        





nc=c(0.9,0.95,0.99)
alfa=1-nc
alfa2=alfa/2

dn=round(qnorm(alfa2,mean=0, sd=1),3)
ncp <- seq(0, 6, length.out = 31)
dt=round(dt(df=2,ncp))


data <- data.frame(nc,alfa,alfa2,-dn)

colnames(data)=c("Nivel de confianza","alfa","alfa/2","Cuantil")
data <- SharedData$new(data)

distri=c("normal", "t-student")

nro=c(1:10)

shiny::fluidRow(
  shiny::column(
    1,
     filter_checkbox("distri", "distri", data, ~distri),
    filter_select("qb", "Grados de libertad", data, ~nro)
  ),
  shiny::column(
    10,
    reactable(data, 
               defaultColDef = colDef(
    header = function(value) gsub(".", " ", value, fixed = TRUE),
    cell = function(value) format(value, nsmall = 1),
    align = "center",
    minWidth = 70,
    headerStyle = list(background = "#f7f7f8")
  ),
  columns = list(
    distri = colDef(minWidth = 140)  # overrides the default
  ),
                        minRows = 3)
  )
)


```


# Intervalo de confianza para una muestra

## IC para la media



```{r}
library(DiagrammeR)

DiagrammeR("graph TB;
  
  A{sigma conocida}-->|Si| C[Normal]
  A-->|No| B{n mayor q 30}
  B-->|No| D[t student]
  B-->|Si| C
  
           ")
            
```
### con la varianza conocida

Si $\bar x$ es la media de una muestra aleatoria de tamaÃ±o ğ‘› de una poblaciÃ³n normal con varianza $\sigma^2$ conocida, un intervalo de
confianza del 1 âˆ’ ğ›¼ 100% para ğœ‡ estÃ¡ dado por:


$$\huge \bar x-Z_{\alpha/2} \frac{\sigma}{\sqrt n} \leq \mu \leq \bar x+Z_{\alpha/2} \frac{\sigma}{\sqrt n}$$

donde $Z_{\alpha/2}$ es el valor z que deja un Ã¡rea de ğ›¼/2 a la derecha.


**Ejemplo**
Una muestra aleatoria de 110 relÃ¡mpagos dieron por resultado una duraciÃ³n de eco de radar promedio muestral de 0.81 segundos y una desviaciÃ³n estÃ¡ndar de 0.34 segundos. Calcule un intervalo de confianza de 95% para la duraciÃ³n de eco promedio e interprete el intervalo resultante

```{r}
library(BSDA)
zsum.test(mean.x=0.81,sigma.x=0.34, n.x=110,conf.level=0.95)

```



*Intervalo de confianza para la media con varianza conocida*

<iframe width="280" height="160" src="https://www.youtube.com/embed/tnDFgEv_a-I?list=RDCMUCMLQ_dQirjjwPjR8skwX3gA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>


### con la varianza desconocida

Si $\bar x$ es la media de una muestra aleatoria de tamaÃ±o ğ‘› de una poblaciÃ³n normal con varianza $\sigma^2$ desconocida, un intervalo de confianza del 1 âˆ’ ğ›¼ 100% para ğœ‡ estÃ¡ dado por:


$$\huge \bar x-t_{\alpha/2} \frac{s}{\sqrt n} \leq \mu \leq \bar x+t_{\alpha/2} \frac{s}{\sqrt n}$$

donde $Z_{\alpha/2}$ es el valor z que deja un Ã¡rea de ğ›¼/2 a la derecha.


**Ejemplo**
Se tienen los datos de las horas de ejercicio que hacen 10 adolescentes por semana, calcule un intervalo de confianza para el tiempo promedio con un NC del 90%


```{r}

library(carData)

carData::Blackmore$exercise[1:10]

x=carData::Blackmore$exercise[1:10]

t.test(x=x,conf.level = 0.9)

```

## IC para la proporciÃ³n

Si $\hat p$ es la proporciÃ³n de Ã©xitos en una muestra aleatoria de tamaÃ±o ğ‘›, un intervalo de confianza aproximado de (1âˆ’ğ›¼) 100% para ğ‘ estÃ¡ dado por 

$$\huge \hat p-Z_{\alpha/2} \sqrt{\frac{\hat p(1-\hat p)}{n}}\leq p \leq \hat p+Z_{\alpha/2} \sqrt{\frac{\hat p(1-\hat p)}{n}} $$


donde $ğ‘_{ğ›¼/2}$  es el valor z que deja un Ã¡rea de ğ›¼/2 a la derecha. Nota: usar solo cuando ğ‘›ğ‘â‰¥50 y ğ‘›(1 âˆ’ğ‘)â‰¥50

**EJEMPLO**
Se seleccionÃ³ una muestra de 487 mujeres no fumadoras de peso normal (que habÃ­a dado a luz). 7.2% de estos nacimientos dieron por resultado niÃ±os con bajo peso al nacer (menos de 2500 g). Calcule un intervalo de confianza con un nivel de confianza del 93% para la proporciÃ³n de todos esos nacimientos que dieron por resultado niÃ±os de bajo peso al nacer.

```{r}
prop.test(x=72,n=1000,conf.level=0.93)
```



*Intervalo de confianza para la proporciÃ³n*

<iframe width="280" height="160" src="https://www.youtube.com/embed/oJv6d9IECRo?list=RDCMUCMLQ_dQirjjwPjR8skwX3gA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>


## IC para la varianza

Si $ğ‘ ^2$ es la varianza de una muestra aleatoria de tamaÃ±o ğ‘› de una poblaciÃ³n normal, un intervalo de confianza aproximado de (1âˆ’ğ›¼) 100% para $ğœ^2$ estÃ¡ dado por 

$$\huge \frac {(nâˆ’1)ğ‘ ^2}{\chi^2_{ \frac {ğ›¼} {2},ğ‘›âˆ’1} } <ğœ^2<\frac {(nâˆ’1)ğ‘ ^2}{\chi^2_{1- \frac {ğ›¼} {2},ğ‘›âˆ’1} }$$

donde los denominadores son obtenidos de una chi-cuadrada. 
Nota: un intervalo de confianza para ğœ se puede obtener tomando raÃ­z cuadrada en los lÃ­mites del intervalo anterior.

**Ejemplo**
Se tienen los datos de las horas de ejercicio que hacen 10 adolescentes por semana, calcule un intervalo de confianza para la varianza del tiempo con un NC del 98%.

```{r}

library(EnvStats)
library(carData)

carData::Blackmore$exercise[1:10]

x=carData::Blackmore$exercise[1:10]

varTest(x, conf.level=0.95)

```

*Intervalo de confianza para la varianza*

<iframe width="280" height="160" src="https://www.youtube.com/embed/Pw66ZHxzAF4?list=RDCMUCMLQ_dQirjjwPjR8skwX3gA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>



# Intervalos de confianza para dos muestras





*Intervalo de confianza para la diferencia de medias con varianzas iguales*

<iframe width="280" height="160" src="https://www.youtube.com/embed/aMOINMuUXVc?list=RDCMUCMLQ_dQirjjwPjR8skwX3gA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

*Intervalo de confianza para la diferencia de medias con varianzas desconocidas y diferentes*

<iframe width="280" height="160" src="https://www.youtube.com/embed/YIImQIRDGMg?list=PLfX5C7cc6LRKG-OUUatElez6mzu1B9UjR" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

*Intervalo de confianza para la razÃ³n de varianzas*

<iframe width="280" height="160" src="https://www.youtube.com/embed/SzXfVJbPh-0?list=PLfX5C7cc6LRKG-OUUatElez6mzu1B9UjR" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

*Intervalo de confianza para la diferencia de proporciones*

<iframe width="280" height="160" src="https://www.youtube.com/embed/Bwbe7cvkDn4?list=PLfX5C7cc6LRKG-OUUatElez6mzu1B9UjR" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

*Intervalo de confianza para la diferencia de medias pareadas*

<iframe width="280" height="160" src="https://www.youtube.com/embed/hcEaKfN28Y0?list=PLfX5C7cc6LRKG-OUUatElez6mzu1B9UjR" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<a href="tallerIC.html" target="_blank"> Taller intervalos de confianza</a>

